## 说明
    在System.DirectoryService名称空间中，Microsoft没有重写COM对象来访问层次结构的数据存储器。实际上是访问ADSI COM对象的包装器。  

    COM（Component Object Model）是.NET以前的技术。COM定义了一个组件模型，在该模型中，组件可以用不同的编程语言进行编写。

## COM
### 1. 元数据
在COM中，组件的所有信息都存储在类型库中。类型库包含的信息有接口、方法和参数的名称ID等。在.Net中，这些信息都存储在程序集中。  
COM存在的问题是类型库是不能扩展的。  
因此,一些 CoM组件有类型库,而其他 CoM组件没有。如果没有类型库可用,就可以使用
C++头文件来描述接口和方法。在.NET中 ,使用带有类型库的COM组件比较容易,也可使用不带 类型库的CoM组件。在这种情况下,必须使用 C#代码重新定义 COM接口。

### 2. 释放内存
在.net中，内存的释放由垃圾收集器完成，COM依赖引用计数。  
IUnknown接口是每个COM对象必须实现的接口，它提供了3个方法。其中两个方法与引用计数有关。如果需要另一个接口指针，客户端必须调用AddRef()，这个方法递增引用计数，Release()递减引用计数。

### 3. 接口
接口是COM的核心，它区分了在客户端和对象之间使用契约和实现方式。接口定义了由组件提供的方法，可以由客户端使用。  
COM区分3中接口类型
- 自定义接口  
    自定义接口派生自IUnknown接口。
- 调度接口(dispatch interface)  
    脚本客户端不支持自定义接口，所以需要使用IDispatch接口。IDispatch接口派生自IUnknown接口，还提供了4个方法。
- 双重接口  
    由于调度接口比自定义接口慢，脚本客户端不能使用自定义接口，那么双重接口可以解决这个问题。


## 参考
1. C#经典 26互操作性